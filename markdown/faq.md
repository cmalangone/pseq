## **F**requently **A**sked **Q**uestions

#### Table of Contents
* [Who should I contact to report bugs or issues?](#bug-reports)
* [What web browser(s) can I use?](#web-browser)
* [How I load a subset of a dataset?](#load-subset)
* [What do you mean by "Filter cutoff"?](#filtercutoff)
* [What do you mean by "Filter out RNA/MT/pseudo genes"?](#filtergenes)
* [What are the transformation methods for counts?](#subqctran)
* [What is metadata?](#metadata)
* [How do I load user-updated metadata?](#meta_user)
* [For scRNA-Seq datasets, what is meant by "Select type of clustering"?](#typecluster)
* [What is "Detection rate threshold"?](#drt)]
* [What is count data?](#count-mat)
* [What is normalized data?](#norm-mat)
* [How do I download raw count data?](#download-counts)
* [How do I download normalized data?](#download-normalized)
* [How do I download metadata?](#download-metadata)
* [Where can I see how many genes and samples are in my dataset?](#genes-and-samples)
* [What are the plots showing on the `Submit and quality control`/`Summary`/`Count summary` page?](#countsummary-plots)
* [What are heatmaps?](#heatmaps)
* [What is the Pearson correlation coefficient?](#pearson)
* [Why would I want to down sample the `Correlation heatmap`](#corheatmap)
* [What does the `Correlation scatterplot` represent?](#corscatter)
* [What does DE/DGE mean?](#dge)
* [Under bulk RNA-Seq, what is the difference between the experimental design parameters under `Choose an experimental design`?](#parameters)
* [How do the three DE approaches differ: DESeq2, LIMMA and edgeR?](#dgetype)
* [What is "Adj. $p$-value cutoff"?](#adjpval)
* [What is "Min. fold change"?](#minlfc)
* [What is an MA plot?](#maplot)
* [What is a volcano plot?](#volplot)
* [What does `Resolution:` mean in the scRNA-Seq analysis?](#res)
* [What is False Discovery Rate (FDR)?](#fdr)
* [What are `Silhouette widths`?](#silhouette)
* [What does nCount_RNA mean?](#ncount)
* [What does nFeature_RNA mean?](#nfeature)
* [Under scRNA-Seq DGE Analysis Overview tab: What does `Factor counts per cluster` mean?](#metarel)
* [What is the Wilcoxon Rank Sum Test?](#wilcox)
* [What are the different algorithms used for scRNA-Seq DGE?](#scdge)
* [Under scRNA-Seq DGE Analysis Volcano plots tab: What data is downloaded when you click `Download cluster A gene stats`?](#volclus)
* [Under scRNA-Seq DGE Analysis Volcano plots tab: What data is downloaded when you click `Download DE results`?](#volde)
* [What data is downloaded when you click `Download gene modules`?](#wgcnagene)
* [What data is downloaded when you click `Download sample modules`?](#wgcnasample)
* [What does `Clip dendrogram` mean in WGCNA clustering analysis?](#wgcnaclip)
* [References](#refs)

- - -

#### Who should I contact to report bugs or issues? <a id="bug-reports"></a>
Report bugs or issues to Claire Malley ([claire.malley@nih.gov](mailto:claire.malley@nih.gov)).

<br>

#### What web browser(s) can I use? <a id="web-browser"></a>
We suggest using Chrome.

<br>

#### How do I load a subset of a dataset? <a id="load-subset"></a>
On `Submit and quality control`/`Load data`, choose one or more datasets in the **Select datasets** table, then click `Choose samples` under the table. Tables will be displayed on the right under **Select samples**, one for each dataset selected. Use the `Select factor` parameter to the right of each table to select a factor to use for subsetting each dataset (e.g., Condition). Click the row(s) corresponding to the level(s) of the factor(s) to include in the subsetted data. To save the subsetted data in a new dataset which can be loaded later, check the `Save merged samples in new dataset` box and provide a name and description for the new dataset. Finally, click `Load merged data` to load the subsetted data. Proceed as usual to submit the data for analysis and visualization.    

<br>

#### What do you mean by "Filter cutoff"? <a id="filtercutoff"></a>
A "filter cutoff" is a numerical parameter ($n$) that is used to remove genes with counts $< n$. For bulk RNA-seq, the default is $10$ but this can be changed by setting `Filter cutoff (count data row sums <n)` on `Submit and quality control`/`Load data` to any integer $\geq 0$. Set to $0$ to skip filtering. For single-cell RNA-seq, no filtering is performed at this stage. 

<br>

#### What do you mean by "Filter out RNA/MT/pseudo genes"? <a id="filtergenes"></a>
The "Filter out RNA/MT/pseudo genes" selection filters out RNA, mitochondrial and pseudo genes from the downstream analysis. The list of genes is a curated list generated by the NIH NCATS group.

<br>

#### What are the transformation methods for counts? <a id="subqctran"></a>
Please see the tutorial section `Submit and quality control`/`Load data`/`Submit data`/`Bulk RNA-seq`.

<br>

#### What is metadata? <a id="metadata"></a>
Metadata, also known as a condition matrix, details the design of your experiment. In this type of matrix, every $i$-th row and $j$-th column refer to factor levels assigned to sample $i$ and factor $j$. For example, if we were to look at the samples given in the [count data](#count-mat) section, the metadata `R` output will look something like this:

                             Condition  Day Lane
    untreated_day1_rep1_L001 untreated day1 L001
    untreated_day1_rep1_L002 untreated day1 L002
    untreated_day1_rep1_L003 untreated day1 L003
    untreated_day1_rep1_L004 untreated day1 L004

<br>

#### How do I load user-updated metadata? <a id="meta_user"></a>
If you have merged clusters or combined cells (`Combining clusters or cells`), there is an option to load these updated clusters instead of the original metadata. After selecting your desired datasets (under `Select datasets`), the table `Option: Select user-updated metadata` will appear. Select the desired user-updated metadata row and click `Load selected data`. The `Option: Select user-updated metadata` will only appear if an end-user has created user-updated metadata associated with the selected dataset.

<br>

#### For scRNA-Seq datasets, what is meant by "Select type of clustering"? <a id="typecluster"></a>"
For each scRNA-Seq dataset, there are pre-identified clusters that the end-user can use to explore the dataset under `Use pre-assigned clusters in metadata`. Alternatively, if the end-user would prefer to explore multiple resolutions, they can select `Run multiple resolutions using seurat'. The selection of multiple resolutions creates multiple Seurat objects, run at resolutions from 0.4 to 2.8 (step size of 0.4) that the end-user can explore downstream.

<br>

#### What is "Detection rate threshold"? <a id="drt"></a>
The `Detection rate threshold` is used to test only genes that are detected in a minimum fraction of cells during differential gene expression.

<br>

#### What is count data? <a id="count-mat"></a>
Count data, also referred to as raw counts, an expression matrix, or a count matrix, refer to data where every $i$-th row and $j$-th column refer to how many reads are assigned to gene (ID) $i$ in sample $j$. For example, if we have simplified count data for 4 samples and 4 genes, the `R` output will look something like this:

           untreated_day1_rep1_L001 untreated_day1_rep1_L002 untreated_day1_rep1_L003 untreated_day1_rep1_L004
    OR4F5                         0                        0                        0                        0
    OR4F29                        0                        0                        0                        0
    OR4F16                        0                        0                        0                        0
    SAMD11                        0                        0                        3                        0

<br>

#### What is normalized data? <a id="norm-mat"></a>
Normalized data refers to data where raw counts have been adjusted so the expression levels for a given gene are more comparable across samples or cells. For bulk RNA-seq, you have a choice of normalization methods, including normal log, regularized log, variance stabilizing transform, and no transformation. For single-cell RNA-seq, counts for a gene from a given cell are divided by the total counts for that cell, multiplied by a scale factor (10000), and natural-log transformed using `log1p` which adds 1 before transforming. 

<br>

#### How do I download raw count data? <a id="download-counts"></a>
After submitting data, go to `Submit and quality control`/`Summary` and click `Download raw counts`.

<br>

#### How do I download normalized data? <a id="download-normalized"></a>
After submitting data, go to `Submit and quality control`/`Summary` and click `Download normalized data`.

<br>

#### How do I download metadata? <a id="download-metadata"></a>
After submitting data, go to `Submit and quality control`/`Summary`, scroll down to the **Sample metadata** table, and click `Download metadata`.

<br>

#### Where can I see how many genes and samples are in my dataset? <a id="genes-and-samples"></a>
After submitting data, go to `Submit and quality control`/`Summary`/`File summary`. **Number of ids (pre-filtration)** indicates the number of genes before filtering is applied. **Number of ids (post-filtration)** indicates the number of genes after filtering is applied. **Number of samples** or **Number of cells** indicate the number of samples (for bulk RNA-seq) or cells (for single-cell RNA-seq), respectively. 

<br>

#### What are the plots showing on the `Submit and quality control`/`Summary`/`Count summary` page? <a id="countsummary-plots"></a>
Please see the tutorial section `Submit and quality control`/`Data summary`/`Count summary`. 

<br>

#### What are heatmaps? <a id="heatmaps"></a>
Heatmaps are plots that enable visualization of gene expression profiles across samples or cells using colors to represent gene expression levels.  

<br>

#### What is the Pearson correlation coefficient?] <a id="pearson"></a>
The Person correlation coefficient is the covariance of two variables (**r**). The coefficient is the covariance of the two variables divided by the product of their standard deviations, which means it is a normalized measurement of covariance with a value between -1 and 1.

<br>

#### Why would I want to down sample the `Correlation heatmap`? <a id="corheatmap"></a>"
For very large scRNA-Seq datasets, it takes a long time to create the correlation matrix, so there is an option to down sample the number of cells and the number of genes. The randomly sampled correlation heatmap will give the end-user an idea of correlation across cells and genes without taking up a lot of time and RAM to build the full matrix.

<br>

#### What does the `Correlation scatterplot` represent? <a id="corscatter"></a>
The `Correlation scatterplot` shows the two selected samples (or cells) clicked on in the `Correlation heatmap` and the normalized transformed count data associated with each gene in the given samples (or cells).

<br>

#### What does DE/DGE mean? <a id="dge"></a>
DE and DGE  mean **d**ifferentially **e**xpressed and **d**ifferential **g**ene **e**xpression, respectively.

<br>

#### What is the difference between the experimental design parameters under `Choose an experimental design`? <a id="parameters"></a>
A detailed description of the types of experimental design can be found in the `Tutorial` under **Bulk RNA-Seq** and **Run DGE**.

<br>

#### How do the three DE approaches differ: DESeq2, LIMMA and edgeR? <a id="dgetype"></a>
All three approaches are used to determine differential expressed (**DE**) genes. DESeq2 and edgeR are similar in that the assumption is that no genes are differentially expressed. DESeq2 uses a "geometric" normalization method whereas edgeR uses a weighted man of log ratios-based method. Both of these approaches normalize data prior to performing DE.
<br>

LIMMA uses quantile normalization with an attempt to match gene count distributions across samples in the dataset.

<br>

#### What experimental designs are allowed for bulk RNA-seq data?<a id="expdesign"></a>
Please see the tutorial section `DGE analysis`/`Bulk RNA-seq`/`Run DGE`. 

<br>

#### What is "Adj. $p$-value cutoff"? <a id="adjpval"></a>
Please see the tutorial section `DGE analysis`/`Run DGE`/`DGE parameters`.

<br>

#### What is "Min. fold change value"? <a id="minlfc"></a>
Please see the tutorial section `DGE analysis`/`Bulk RNA-seq`/`Run DGE`/`DGE parameters`.

<br>

#### What is an MA plot? <a id="maplot"></a>
Please see the tutorial section `DGE analysis`/`Bulk RNA-seq`/`Volcano plots`.

<br>

#### What is a volcano plot <a id="volplot"></a>
Please see the tutorial section `DGE analysis`/`Bulk RNA-seq`/`Volcano plots`.

<br>

#### What does `Resolution:` mean in the scRNA-Seq analysis? <a id="res"></a>
For each scRNA-Seq dataset, there are pre-identified clusters that the end-user can use to explore the dataset under `Use pre-assigned clusters in metadata`. Alternatively, if the end-user would prefer to explore multiple resolutions, they can select `Run multiple resolutions using seurat'. The selection of multiple resolutions creates multiple Seurat objects, run at resolutions from 0.4 to 2.8 (step size of 0.4). Under the DGE Analysis tabs, the end-user can select which resolution to explore visually, for DE and gene set enrichment.

<br>

#### What are `Silhouette widths`? <a id="silhouette"></a>
`Silhouette widths` provide a metric for assessing the contribution of each cell to cluster cohesion and separation (Rousseeuw 1987).

<br>

#### What is False Discovery Rate (FDR)? <a id="fdr"></a>
The False Discovery Rate (FDR) is the expected proportion of Type 1 error (incorrectly rejected the null hypothesis or false positive).

<br>

#### What does nCount_RNA mean? <a id="ncount"></a>
The nCount_RNA value is calculated when the Seurat object is built. It refers to the count of RNAs in a given cluster.

<br>

#### What does nFeature_RNA mean? <a id="nfeature"></a>
The nFeature_RNA value is calculated when the Seurat object is built. It refers to the number of genes in a given cluster.

<br>

#### In the scRNA-Seq DGE Analysis Overview tab: What does `Factor counts per cluster` mean? <a id="metarel"></a>
When exploring the metadata in the `Metadata individual plot`, if a factor variable is selected, the end-user will have the option to view counts as `Absolute` or `Relative`, where the former is the actual counts of cells and the latter is the relative proportion of cells.

<br>

#### What is the Wilcoxon rank sum test? <a id="wilcox"></a>
The Wilcoxon Rank Sum Test is a non-parametric test, and the null hypothesis of the test is that the distribution of the two datasets being compared are the same. The assumptions for the Wilcoxon Rank Sum Test is that the samples are independent, but their variances do not have to be equal and their distributions do not have to be normally distributed.

<br>

#### What are the different algorithms used for scRNA-Seq DGE? <a id="scdge"></a>
There are several different algorithms that can be used in Seurat to identify differentially expressed genes. The end-user has the option to use any of the following in the `DGE custom` tab: Wilcoxon Rank Sum, bimod, roc, t, negative binomial, poisson, logistic regression , MAST, DESeq. Below is a brief description for each.

`Wilcoxon Rank Sum` - described above
`bimod` - Likelihood ratio test for singel cell feature expression (McDavid *et al.* 2013)
`roc` - AUC classifier (*A*rea *U*nder the ROC [*R*eceiver *O*perating *C*haracteric] *C*urve).
`t` - Student's t-test
`poisson` - Likelihood ratio test with a Poisson distribution underlying distribution (only UMI datasets)
`negative binomial` - Likelihood ratio test with a negative binomial underlying distribution (only UMI datasets)
`logistic regression` - Constructs a logistic regression model to predict group membership based on each feature individually and compares the model to a null model with a likelihood ratio test
`MAST` - General linear model (GLM) that treats cellular detection rate as a covariate (Finak *et al.* 2015)
`DESeq2` - Differential expression based on a model using the negative binomial distribution (Love *et al.* 2014)

<br>

#### Under scRNA-Seq DGE Analysis Volcano plots tab: What data is downloaded when you click `Download cluster A gene stats`? <a id="volclus"></a>
The statistics downloaded are: Mean log-normalized transcript count per cluster (mean gene expression - MGE), the proportion of cells in the cluster in which the gene was detected (detection rate - DR) and the mean log-normalized transcript count from the cells in which the gene was detected (mean detected gene expression - MDGE). The gene symbols are in the row names.

<br>

#### Under scRNA-Seq DGE Analysis Volcano plots tab: What data is downloaded when you click `Download DE results`? <a id="volde"></a>
The statistics downloaded are: The difference in mean gene expression (gene expression ratio -logGER), the difference in detection rate (dDR), the Wilcoxon Rank Sum test statistic (Wstat), p-value (pVal) and False Discovery Rate (FDR).

<br>

#### Under scRNA-Seq DGE Analysis Clustering tab: What data is downloaded when you click `Download gene modules`? <a id="wgcnagene"></a>
When the end-user clicks on `Download gene modules`, the genes from the dataset along with the module they were placed in are stored in a .csv file. Modules are identified by color.

<br>

#### Under scRNA-Seq DGE Analysis Clustering tab: What data is downloaded when you click `Download sample modules`? <a id="wgcnasample"></a>
When the end-user clicks on `Download sample modules`, the metadata table for the dataset along with the module each sample or cluster were placed in are stored in a .csv file. Modules are identified by color.

<br>

#### What does `Clip dendrogram` mean in WGCNA clustering analysis? <a id="wgcnaclip"></a>
If the end-user selects `Clip dendrogram`, the dendrogram branches will not extend to the base of the plot (Height = 0).

<br>

#### References <a id="refs"></a>
Finak G, McDavid A, Yajima M, Deng J, Gersuk V, Shalek A. K, Slichter C. K, Miller H. W, McElrarth J, Prlic M and Linsley P. S (2015). "MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data." Genome Biology 16: 278

Love, Michael I., Wolfgang Huber, and Simon Anders. (2014). “Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2.” Genome Biology 15(12): 550.

McCarthy, J. D, Chen, Yunshun, Smyth and K. G (2012). “Differential expression analysis of multifactor RNA-Seq experiments with respect to biological variation.” Nucleic Acids Research, 40(10), pp. 4288-4297.

McDavid A, Finak G, Chattopadyay P. K, Dominguez M, Lamoreaux L, Ma S. S, Roederer M and Gottardo R (2013). "Data exploration, quality control and testing in single-cell qPCR-based gene expression experiment." Bioinformatics 29(4): 461-467 

Monier B, McDermaid A, Wang C *et al.*. IRIS-EDA: an integrated RNA-Seq interpretation system for gene expression data analysis, PLoS Comp Bio 2019;15(2): e1006792

Tibshirani, Robert. 1988. “Estimating Transformations for Regression via Additivity and Variance Stabilization.” Journal of the American Statistical Association 83: 394–405.

Ritchie ME, Phipson B, Wu D, Hu Y, Law CW, Shi W and Smyth GK (2015). “limma powers differential expression analyses for RNA-sequencing and microarray studies.” Nucleic Acids Research, 43(7), pp. e47.

Robinson MD, McCarthy DJ and Smyth GK (2010). “edgeR: a Bioconductor package for differential expression analysis of digital gene expression data.” Bioinformatics, 26(1), pp. 139-140.

Rousseeuw PJ (1987). "Silhouettes: A graphical aid to the interpretation and validation of cluster analysis." Journal of Computational Applied Mathematics, 20(6385), pp. 53-65.

<br>
<br>
<br>
