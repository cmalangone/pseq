1. Choose between **DGE filtered** and a **Custom** gene list. The number of genes and cells to be included in the heatmap, based on your chosen parameters, will be displayed.

    **DGE filtered**
    
    a. Select a contrast between two clusters.

    b. Choose whether to include all differentially expressed (DE) genes or only those that are up in one cluster or another.

    c. Choose the number of top DE genes to include. Check **Use all genes passing filters** to include all DE genes, based on your chosen parameters, that meet the detection rate threshold chosen on the initial load page and a 5% false discovery rate.

    d. Choose 1 or more enrichR libraries or accept the default selections.

    **Custom**  
    Paste a comma- or space-delimited list of genes in the **Paste genes** box.

2. Choose a color palette.

3. Select one or more factors to concatenate together as group labels for cells.

4. Choose whether to cluster the genes and/or cells.

5. The heatmap will show all cells by default. To show only samples from the chosen contrast (when **DGE filtered** is chosen as the gene list), select **Use cells from contrast only**.

6. Click **Build heatmap**.

    Click on any gene (row) in the heatmap to view a more detailed plot below the heatmap.
